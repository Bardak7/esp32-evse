os: linux
dist: focal
language: shell
addons:
  apt:
    packages:
    - git
    - wget
    - flex
    - bison
    - gperf
    - python3
    - python3-pip
    - python3-setuptools
    - cmake
    - ninja-build
    - ccache
    - libffi-dev
    - libssl-dev
install:
- mkdir ~/esp
- cd ~/esp
- git clone -b release/v4.1 --recursive https://github.com/espressif/esp-idf.git
- cd ~/esp/esp-idf
- "./install.sh"
- ". ~/esp/esp-idf/export.sh"
script:
- cd $TRAVIS_BUILD_DIR
- idf.py reconfigure
- idf.py build
- idf.py size
branches:
  only:
  - master
deploy:
  provider: releases
  api_key:
    secure: el3uBSEYCncaLy1EQxoydk80UTXtBYqNc4PSflaC2oqkYdIlmk2vmGpK/3acw/nb6Gs9RNPCpwegmCu1t+10INi3gvCPmUhGSAsuhGIFFksHiR3VJu4R1rRzpeg8poivMMwbuZN4m5Slk5TI2D4U42YaS7BMx605V2PlV75rqgbnWI8OGLAWaV/HL98+KqoWTzaGCN/myTP9tzhIIlqOttoAqaBB4vZYW2+mFHPr8XGySYXDJn0YmdLJk3QR/W8i+/IjUJe+yYi5NwQOeq1Dzr5EVM52dfeC2odNpeOiLM8VRHl0IETBByg3lVzR7HSwXXdaRslkUw2jkKGK6N2vhy5MC7wJ+PshiqeK8stdgDCUWJvn7IwdJ6H8HarYJ3B0h2PairHR1WSqlUJnUTXps3ardbI7YMop9pMBovkVGq4sItkNQUurpEHUs2qQLnPnc2f6ksWA6kTG01l6fHFOQGgNyPg+bwNmQ0eD8bjG+9ImnwuEQmaL2m96/oJHG9aWIlWfpvxCBTAt9iTFjqtzl5FQGe24FFoK0POuEemaGNDiQC8+i9bC31pw2GtGlPK1lTGcGYDhCcMDrHvem1Ip1lq7EeY+bMCdqpCT5ssHV0sv4F3Nqs5zl22M4O5jkLMA7l92U3Br495F5eP3TtZBdnx7alILOUiE9c/3ntCKnxo=
  file: build/esp32-evse.bin
  on:
    repo: dzurikmiroslav/esp32-evse
